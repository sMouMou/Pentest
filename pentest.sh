#!/bin/bash

function menu() {

        # COMMAND MENU
        echo "========COMMAND========"
        echo "1 : PING"
        echo "2 : NMAP"
        echo "3 : RUSTSCAN"
        echo "4 : GOBUSTER"
        echo "========COMMAND========"
        read -p "SCRIPT : " script

        if [ -z $script ] ; then

                echo "Please select a command"
                menu

        elif [ $script = '1' ] ; then

                echo "PING!"
                ping -c 3 $target

        elif [ $script = '2' ] ; then

                echo "NMAP!"
                runnmap

        elif [ $script = '3' ] ; then

                echo "RUSTSCAN!"
                runrustscan

        elif [ $script = '4' ] ; then

                echo "GOBUSTER!"
                rungobuster

        else

                echo "Please select a command"
                menu

        fi

        echo "========NEXT========"
        echo ""
        read -p "Next Command(y/n) : " next

        if [ $next = 'y' ] ; then

                menu

        else

                echo "GoodBye!"
                exit 1

        fi

}

function runnmap() {

        # RUN NMAP
        echo "========SCANTYPE========"
        echo "1 : BASIC"
        echo "2 : TCPSCAN"
        echo "3 : UDPSCAN"
        echo "4 : SCRIPTSCAN"
        echo "========SCANTYPE========"
        read -p "SCAN : " scan
        read -p "log file name : " log

        if [ -z $log ] ; then

                echo "Please specify the name of the log file"
                runnmap

        else

                if [ -z $scan ] ; then

                        echo "Please select a scan type"
                        runnmap

                elif [ $scan = '1' ] ; then

                        echo "TYPE 1"
                        sudo nmap -Pn -n -v --reason -sS -p- --min-rate=1000 -A $target -oN $log

                elif [ $scan = '2' ] ; then

                        echo "TYPE 2"
                        sudo nmap -sT -T4 $target -oN $log

                elif [ $scan = '3' ] ; then

                        echo "TYPE 3"
                        sudo nmap -sU -T4 $target -oN $log

                elif [ $scan = '4' ] ; then

                        echo "TYPE 4"
                        sudo nmap -T4 --script vuln $target -oN $log 

                else

                        echo "Please select a scan type"
                        runnmap

                fi

        fi

}

function runrustscan() {

        # RUN RUSTSCAN
        rustscan -a $target -- -A -T4 -sC -sV -Pn

}

function rungobuster() {

        # RUN GOBUSTER
        echo "========WORDFILE========"
        echo "1 : common.txt"
        echo "2 : big.txt"
        echo "3 : raft-small-directories-lowercase.txt"
        echo "========WORDFILE========"
        read -p "WORD : " word
        read -p "log file name : " log

        if [ -z $log ] ; then

                echo "Please specify the name of the log file"
                rungobuster

        else

                if [ -z $word ] ; then

                        echo "Please select a word file"
                        rungobuster

                elif [ $word = '1' ] ; then

                        echo "TYPE 1"
                        gobuster dir -u http://$target -w /usr/share/wordlists/dirb/common.txt -o $log

                elif [ $word = '2' ] ; then

                        echo "TYPE 2"
                        gobuster dir -u http://$target -w /usr/share/seclists/Discovery/Web-Content/big.txt -o $log

                elif [ $word = '3' ] ; then

                        echo "TYPE 3"
                        gobuster dir -u http://$target -w /usr/share/seclists/Discovery/Web-Content/raft-small-directories-lowercase.txt -o $log

                else

                        echo "Please select a word file"
                        rungobuster

                fi

        fi

}

echo "Let's Hacking!"
read -p "TARGET : " target

menu